<head>
  <style>
    .box {
      width: 100px;
      height: 100px;
      background-color: red;
    }

    .enter-active,
    .leave-active {
      transition: transform 1s ease-in-out;
    }
    .enter-from,
    .leave-to {
      transform: translateX(200px);
    }
    .enter-to,
    .leave-from {
      transform: translateX(0);
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    const container = document.querySelector("#app");
    // 创建 class 为 box 的 DOM 元素
    const el = document.createElement("div");
    el.classList.add("box");

    // 在 DOM 元素被添加到⻚⾯之前，将初始状态和运动过程定义到元素上
    el.classList.add("enter-from"); //初试状态
    el.classList.add("enter-active"); //运动过程

    // 将元素添加到⻚⾯
    container.appendChild(el);
    // enter
    nextFrame(() => {
      // 切换元素的状态
      el.classList.remove("enter-from");
      el.classList.add("enter-to");
      // 监听 transitionend 事件完成收尾⼯作
      el.addEventListener("transitionend", () => {
        el.classList.remove("enter-to");
        el.classList.remove("enter-active");
      });
    });

    function nextFrame(cb) {
      requestAnimationFrame(() => {
        requestAnimationFrame(cb);
      });
    }

    el.addEventListener("click", () => {
      // 将卸载动作封装到 performRemove 函数中
      const performRemove = () => el.parentNode.removeChild(el);
      // 设置初始状态：添加 leave-from 和 leave-active 类
      el.classList.add("leave-from");
      el.classList.add("leave-active");
      // 在下⼀帧切换状态
      nextFrame(() => {
        // 切换到结束状态
        el.classList.remove("leave-from");
        el.classList.add("leave-to");
        // 监听 transitionend 事件做收尾⼯作
        el.addEventListener("transitionend", () => {
          el.classList.remove("leave-to");
          el.classList.remove("leave-active");
          // 当过渡完成后，记得调⽤ performRemove 函数将 DOM 元素移除
          performRemove();
        });
      });
    });
  </script>
</body>
